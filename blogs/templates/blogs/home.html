{% extends 'base.html' %}
{% load crispy_forms_tags %}
{% block home-active %}
 active
{% endblock home-active %}
{% load static %}
{% block styler %}
<style>
body{
    background-color:#fff;
}
</style>

{% endblock styler %}


{% block content %}

<div class="row my-3">
    <div class="col-8">
        {% include 'includes/messages.html' %}
        <!-- List of posts -->
        {% for blog in blogs %}
        <div class="card my-3">
            <div class="card-body">
                <img src="{{ blog.author.profile.image.url }}" class="profile-pic-sm" alt="">
                <span>
                    <span class="user-name"><a href="{% url 'blog:user_post' blog.author.username %}"> {{ blog.author.username|title }}</a></span> <br>
                    <small class="text-secondary">{{ blog.author.profile.introduction|title }}</small>
                </span>
                <hr>
                
                <h5 class="card-title text-primary">
                    <a href="{{ blog.get_absolute_url }}"> {{ blog.title }}</a>
                </h5>
                <small class="text-secondary"> <i class="far fa-clock"></i> {{ blog.created_at|timesince }} ago | <i class="fa fa-eye"></i> views: {{ blog.blog_views }} | </small>
                <small><i class="fas fa-tags"></i>   
                    {% for i in blog.category.all %}
                    <span class="badge badge-info">{{ i.title }}</span>
                    {% endfor %}
                </small>        
                <br><br>
                <div class="row">
                    <div class="col-9">
                        <p>{{blog.overview}}</p>
                        <a href="{% url 'blog:blog_detail' blog.slug %}" class="text-primary">(read more)</a>
                    </div>
                    <div class="col-3">
                        <img src="{{ blog.thumbnail.url }}" class="w-100" alt="" style="border-radius:12px;">
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}

        {% include 'blogs/includes/pagination.html' %}
    </div>
    <div class="col-4">
        <!-- About author -->
        <div class="card my-3">
            <img class="card-img-top" src="{% static 'imgs/author.JPG' %}" alt="Card image">
            <div class="card-body">
                <h4 class="card-title">Basir Payenda</h4>
                <p class="card-text">I am a passionate software engineer, I write about Python, Django ... </p>
                <a href="#" class="btn btn-primary">See Profile</a>
            </div>
        </div>

        <!-- Search -->
        <div class="card">
            <div class="card-body">
                <h3 class="mb-2"> <i class="fa fa-search"></i> Search posts</h3>
                <form action="{% url 'blog:search_blogs' %}">
                    {% csrf_token %}
                    <input type="text" name="q" placeholder="Search blogs here" class="form-control">
                    <input type="submit" class="btn btn-primary btn-sm my-3" value="Search">
                </form>
            </div>
        </div>
        <!-- Categories -->
        <div class="card my-3">
            <div class="card-body">
                <h3 class="card-title mb-3"><i class="fas fa-tags"></i>  Tags</h3>
                {% for category in categories %}
                    {% if forloop.last %}
                        <a href="{% url 'blog:category_blogs' category.category__title  %}">{{ category.category__title  }}</a>
                        <span class="badge badge-secondary">{{ category.category__title__count }}</span>
                    {% else %}
                        <a href="{% url 'blog:category_blogs' category.category__title  %}">{{ category.category__title  }}</a>
                        <span class="badge badge-secondary">{{ category.category__title__count }}</span>
                        <hr>
                    {% endif %}
                {% endfor %}
            </div>
        </div>
    </div>
</div>


<!-- End of first row -->

<!-- Subscribe -->
<div class="row">
    <div class="col-12">
        <div class="card bg-secondary text-white">
            <div class="card-body">
                <h3 class="mb-2"> <i class="fa fa-envelope"></i> Subscribe </h3>
                <small class="mb-3">Subscribe to our newsletter to get updates about the content of website</small>
                <form action="{% url 'subscribe' %}" method="POST">
                    {% csrf_token %}
                    {{ subscribe_form|crispy }}
                    <input type="submit" class="btn btn-primary btn-sm my-3" value="Subscribe">
                </form>
            </div>
        </div>
    </div>
</div>
<br>
<!-- Popular posts row -->
<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-body">
                <h1>Popular Posts</h1>
                <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Eligendi odit repellat, dolores nihil distinctio commodi accusantium libero sit ut, maiores totam fugiat nemo expedita cupiditate minus earum quae dolorem sunt!</p>
                <div class="swiper-container">
                    <div class="swiper-wrapper">
                        {% for blog in latest %}    
                            <div class="swiper-slide" style="box-shadow:0 0 5px #f3f3f3; border-radius:7px;">
                                <div class="card">
                                    <div class="card-body">
                                        <img src="{{ blog.thumbnail.url }}" class="w-100" alt="">
                                        <small><h5 class="card-title text-primary"><a href="{{ blog.get_absolute_url }}">{{blog.title}}</a></h5></small> 
                                        <small class="text-secondary pb-3">Post by <a href="#">{{ blog.author }}</a> <i class="fa fa-clock"></i>  {{ blog.created_at|timesince }} ago</small>

                                        <small><p style="display:inline;">{{ blog.overview|truncatechars:90 }}</p></small> 
                                        <a href="{{ blog.get_absolute_url }}">(read more)</a>
                                    </div>
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                    <br><br>
                    <div class="swiper-pagination my-4"></div>
                </div>
            </div>
        </div>
    </div>
</div>


{% endblock content %}


